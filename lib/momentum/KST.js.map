{"version":3,"file":"KST.js","names":["_indicator","require","_SMA","_ROC","KSTInput","IndicatorInput","ROCPer1","ROCPer2","ROCPer3","ROCPer4","SMAROCPer1","SMAROCPer2","SMAROCPer3","SMAROCPer4","signalPeriod","values","exports","KSTOutput","kst","signal","KST","Indicator","result","generator","constructor","input","priceArray","rocPer1","rocPer2","rocPer3","rocPer4","smaPer1","smaPer2","smaPer3","smaPer4","roc1","ROC","period","roc2","roc3","roc4","sma1","SMA","format","v","sma2","sma3","sma4","signalSMA","firstResult","Math","max","index","tick","RCMA1","RCMA2","RCMA3","RCMA4","roc1Result","nextValue","roc2Result","roc3Result","roc4Result","undefined","next","forEach","value","push","calculate","price","nextResult","reverseInputs","reversedInput","reverse"],"sources":["../../src/momentum/KST.ts"],"sourcesContent":["import { Indicator, IndicatorInput } from '../indicator/indicator';\r\nimport { SMA } from '../moving_averages/SMA';\r\nimport { ROC } from './ROC';\r\n\r\nexport class KSTInput extends IndicatorInput {\r\n  ROCPer1 : number;\r\n  ROCPer2 : number;\r\n  ROCPer3 : number;\r\n  ROCPer4 : number;\r\n  SMAROCPer1 : number;\r\n  SMAROCPer2 : number;\r\n  SMAROCPer3 : number;\r\n  SMAROCPer4 : number;\r\n  signalPeriod: number;\r\n  values : number[];\r\n}\r\n\r\nexport class KSTOutput {\r\n  kst:number\r\n  signal:number\r\n}\r\n\r\nexport class KST extends Indicator { \r\n  result : KSTOutput[];\r\n  generator:IterableIterator<KSTOutput | undefined>;\r\n  constructor(input:KSTInput) {\r\n    super(input);\r\n    let priceArray  = input.values;\r\n    let rocPer1     = input.ROCPer1;\r\n    let rocPer2     = input.ROCPer2;\r\n    let rocPer3     = input.ROCPer3;\r\n    let rocPer4     = input.ROCPer4;\r\n\r\n    let smaPer1     = input.SMAROCPer1;\r\n    let smaPer2     = input.SMAROCPer2;\r\n    let smaPer3     = input.SMAROCPer3;\r\n    let smaPer4     = input.SMAROCPer4;\r\n\r\n    let signalPeriod= input.signalPeriod;\r\n\r\n    let roc1        = new ROC({ period : rocPer1, values: []});\r\n    let roc2        = new ROC({ period : rocPer2, values: []});\r\n    let roc3        = new ROC({ period : rocPer3, values: []});\r\n    let roc4        = new ROC({ period : rocPer4, values: []});\r\n\r\n    let sma1        = new SMA({ period : smaPer1, values: [], format : (v) => {return v}});\r\n    let sma2        = new SMA({ period : smaPer2, values: [], format : (v) => {return v}});\r\n    let sma3        = new SMA({ period : smaPer3, values: [], format : (v) => {return v}});\r\n    let sma4        = new SMA({ period : smaPer4, values: [], format : (v) => {return v}});\r\n    let signalSMA   = new SMA({ period : signalPeriod, values: [], format : (v) => {return v}})\r\n    var format = this.format;\r\n    this.result = [];\r\n\r\n    let firstResult = Math.max(rocPer1 + smaPer1, rocPer2+smaPer2, rocPer3+smaPer3, rocPer4+smaPer4);\r\n    this.generator = (function* ():IterableIterator<KSTOutput | undefined>{\r\n      let index = 1;\r\n      let tick = yield;\r\n      let kst;\r\n      let RCMA1,RCMA2,RCMA3,RCMA4,signal,result;\r\n      while (true) {\r\n        let roc1Result = roc1.nextValue(tick);\r\n        let roc2Result = roc2.nextValue(tick);\r\n        let roc3Result = roc3.nextValue(tick);\r\n        let roc4Result = roc4.nextValue(tick);\r\n        RCMA1 = (roc1Result!==undefined) ? sma1.nextValue(roc1Result) : undefined;\r\n        RCMA2 = (roc2Result!==undefined) ? sma2.nextValue(roc2Result) : undefined;\r\n        RCMA3 = (roc3Result!==undefined) ? sma3.nextValue(roc3Result) : undefined;\r\n        RCMA4 = (roc4Result!==undefined) ? sma4.nextValue(roc4Result) : undefined;\r\n        if(index < firstResult){\r\n          index++;\r\n        }else {\r\n          kst = (RCMA1 * 1) + (RCMA2 * 2) + (RCMA3 * 3) + (RCMA4 * 4)\r\n        }\r\n        signal = (kst!==undefined) ? signalSMA.nextValue(kst) : undefined;\r\n        result = kst!==undefined ? {\r\n          kst : format(kst),\r\n          signal : signal ? format(signal) : undefined\r\n        } : undefined;\r\n        tick = yield result;\r\n      }\r\n    })();\r\n\r\n    this.generator.next();\r\n\r\n    priceArray.forEach((tick) => {\r\n      let result = this.generator.next(tick);\r\n      if(result.value != undefined){\r\n        this.result.push(result.value);\r\n      }\r\n    });\r\n  };\r\n\r\n  static calculate = kst;\r\n\r\n\r\n  nextValue (price:number) {\r\n    let nextResult = this.generator.next(price);\r\n    if(nextResult.value != undefined)\r\n      return nextResult.value;\r\n  };\r\n}\r\n\r\nexport function kst(input:KSTInput):KSTOutput[] {\r\n       Indicator.reverseInputs(input);\r\n        var result = new KST(input).result;\r\n        if(input.reversedInput) {\r\n            result.reverse();\r\n        }\r\n        Indicator.reverseInputs(input);\r\n        return result;\r\n    };"],"mappings":";;;;;;;AAAA,IAAAA,UAAA,GAAAC,OAAA;AACA,IAAAC,IAAA,GAAAD,OAAA;AACA,IAAAE,IAAA,GAAAF,OAAA;AAEO,MAAMG,QAAQ,SAASC,yBAAc,CAAC;EAC3CC,OAAO;EACPC,OAAO;EACPC,OAAO;EACPC,OAAO;EACPC,UAAU;EACVC,UAAU;EACVC,UAAU;EACVC,UAAU;EACVC,YAAY;EACZC,MAAM;AACR;AAACC,OAAA,CAAAZ,QAAA,GAAAA,QAAA;AAEM,MAAMa,SAAS,CAAC;EACrBC,GAAG;EACHC,MAAM;AACR;AAACH,OAAA,CAAAC,SAAA,GAAAA,SAAA;AAEM,MAAMG,GAAG,SAASC,oBAAS,CAAC;EACjCC,MAAM;EACNC,SAAS;EACTC,WAAWA,CAACC,KAAc,EAAE;IAC1B,KAAK,CAACA,KAAK,CAAC;IACZ,IAAIC,UAAU,GAAID,KAAK,CAACV,MAAM;IAC9B,IAAIY,OAAO,GAAOF,KAAK,CAACnB,OAAO;IAC/B,IAAIsB,OAAO,GAAOH,KAAK,CAAClB,OAAO;IAC/B,IAAIsB,OAAO,GAAOJ,KAAK,CAACjB,OAAO;IAC/B,IAAIsB,OAAO,GAAOL,KAAK,CAAChB,OAAO;IAE/B,IAAIsB,OAAO,GAAON,KAAK,CAACf,UAAU;IAClC,IAAIsB,OAAO,GAAOP,KAAK,CAACd,UAAU;IAClC,IAAIsB,OAAO,GAAOR,KAAK,CAACb,UAAU;IAClC,IAAIsB,OAAO,GAAOT,KAAK,CAACZ,UAAU;IAElC,IAAIC,YAAY,GAAEW,KAAK,CAACX,YAAY;IAEpC,IAAIqB,IAAI,GAAU,IAAIC,QAAG,CAAC;MAAEC,MAAM,EAAGV,OAAO;MAAEZ,MAAM,EAAE;IAAE,CAAC,CAAC;IAC1D,IAAIuB,IAAI,GAAU,IAAIF,QAAG,CAAC;MAAEC,MAAM,EAAGT,OAAO;MAAEb,MAAM,EAAE;IAAE,CAAC,CAAC;IAC1D,IAAIwB,IAAI,GAAU,IAAIH,QAAG,CAAC;MAAEC,MAAM,EAAGR,OAAO;MAAEd,MAAM,EAAE;IAAE,CAAC,CAAC;IAC1D,IAAIyB,IAAI,GAAU,IAAIJ,QAAG,CAAC;MAAEC,MAAM,EAAGP,OAAO;MAAEf,MAAM,EAAE;IAAE,CAAC,CAAC;IAE1D,IAAI0B,IAAI,GAAU,IAAIC,QAAG,CAAC;MAAEL,MAAM,EAAGN,OAAO;MAAEhB,MAAM,EAAE,EAAE;MAAE4B,MAAM,EAAIC,CAAC,IAAK;QAAC,OAAOA,CAAC;MAAA;IAAC,CAAC,CAAC;IACtF,IAAIC,IAAI,GAAU,IAAIH,QAAG,CAAC;MAAEL,MAAM,EAAGL,OAAO;MAAEjB,MAAM,EAAE,EAAE;MAAE4B,MAAM,EAAIC,CAAC,IAAK;QAAC,OAAOA,CAAC;MAAA;IAAC,CAAC,CAAC;IACtF,IAAIE,IAAI,GAAU,IAAIJ,QAAG,CAAC;MAAEL,MAAM,EAAGJ,OAAO;MAAElB,MAAM,EAAE,EAAE;MAAE4B,MAAM,EAAIC,CAAC,IAAK;QAAC,OAAOA,CAAC;MAAA;IAAC,CAAC,CAAC;IACtF,IAAIG,IAAI,GAAU,IAAIL,QAAG,CAAC;MAAEL,MAAM,EAAGH,OAAO;MAAEnB,MAAM,EAAE,EAAE;MAAE4B,MAAM,EAAIC,CAAC,IAAK;QAAC,OAAOA,CAAC;MAAA;IAAC,CAAC,CAAC;IACtF,IAAII,SAAS,GAAK,IAAIN,QAAG,CAAC;MAAEL,MAAM,EAAGvB,YAAY;MAAEC,MAAM,EAAE,EAAE;MAAE4B,MAAM,EAAIC,CAAC,IAAK;QAAC,OAAOA,CAAC;MAAA;IAAC,CAAC,CAAC;IAC3F,IAAID,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAI,CAACrB,MAAM,GAAG,EAAE;IAEhB,IAAI2B,WAAW,GAAGC,IAAI,CAACC,GAAG,CAACxB,OAAO,GAAGI,OAAO,EAAEH,OAAO,GAACI,OAAO,EAAEH,OAAO,GAACI,OAAO,EAAEH,OAAO,GAACI,OAAO,CAAC;IAChG,IAAI,CAACX,SAAS,GAAI,aAAoD;MACpE,IAAI6B,KAAK,GAAG,CAAC;MACb,IAAIC,IAAI,GAAG,KAAK;MAChB,IAAInC,GAAG;MACP,IAAIoC,KAAK,EAACC,KAAK,EAACC,KAAK,EAACC,KAAK,EAACtC,MAAM,EAACG,MAAM;MACzC,OAAO,IAAI,EAAE;QACX,IAAIoC,UAAU,GAAGvB,IAAI,CAACwB,SAAS,CAACN,IAAI,CAAC;QACrC,IAAIO,UAAU,GAAGtB,IAAI,CAACqB,SAAS,CAACN,IAAI,CAAC;QACrC,IAAIQ,UAAU,GAAGtB,IAAI,CAACoB,SAAS,CAACN,IAAI,CAAC;QACrC,IAAIS,UAAU,GAAGtB,IAAI,CAACmB,SAAS,CAACN,IAAI,CAAC;QACrCC,KAAK,GAAII,UAAU,KAAGK,SAAS,GAAItB,IAAI,CAACkB,SAAS,CAACD,UAAU,CAAC,GAAGK,SAAS;QACzER,KAAK,GAAIK,UAAU,KAAGG,SAAS,GAAIlB,IAAI,CAACc,SAAS,CAACC,UAAU,CAAC,GAAGG,SAAS;QACzEP,KAAK,GAAIK,UAAU,KAAGE,SAAS,GAAIjB,IAAI,CAACa,SAAS,CAACE,UAAU,CAAC,GAAGE,SAAS;QACzEN,KAAK,GAAIK,UAAU,KAAGC,SAAS,GAAIhB,IAAI,CAACY,SAAS,CAACG,UAAU,CAAC,GAAGC,SAAS;QACzE,IAAGX,KAAK,GAAGH,WAAW,EAAC;UACrBG,KAAK,EAAE;QACT,CAAC,MAAK;UACJlC,GAAG,GAAIoC,KAAK,GAAG,CAAC,GAAKC,KAAK,GAAG,CAAE,GAAIC,KAAK,GAAG,CAAE,GAAIC,KAAK,GAAG,CAAE;QAC7D;QACAtC,MAAM,GAAID,GAAG,KAAG6C,SAAS,GAAIf,SAAS,CAACW,SAAS,CAACzC,GAAG,CAAC,GAAG6C,SAAS;QACjEzC,MAAM,GAAGJ,GAAG,KAAG6C,SAAS,GAAG;UACzB7C,GAAG,EAAGyB,MAAM,CAACzB,GAAG,CAAC;UACjBC,MAAM,EAAGA,MAAM,GAAGwB,MAAM,CAACxB,MAAM,CAAC,GAAG4C;QACrC,CAAC,GAAGA,SAAS;QACbV,IAAI,GAAG,MAAM/B,MAAM;MACrB;IACF,CAAC,CAAE,CAAC;IAEJ,IAAI,CAACC,SAAS,CAACyC,IAAI,CAAC,CAAC;IAErBtC,UAAU,CAACuC,OAAO,CAAEZ,IAAI,IAAK;MAC3B,IAAI/B,MAAM,GAAG,IAAI,CAACC,SAAS,CAACyC,IAAI,CAACX,IAAI,CAAC;MACtC,IAAG/B,MAAM,CAAC4C,KAAK,IAAIH,SAAS,EAAC;QAC3B,IAAI,CAACzC,MAAM,CAAC6C,IAAI,CAAC7C,MAAM,CAAC4C,KAAK,CAAC;MAChC;IACF,CAAC,CAAC;EACJ;EAEA,OAAOE,SAAS,GAAGlD,GAAG;EAGtByC,SAASA,CAAEU,KAAY,EAAE;IACvB,IAAIC,UAAU,GAAG,IAAI,CAAC/C,SAAS,CAACyC,IAAI,CAACK,KAAK,CAAC;IAC3C,IAAGC,UAAU,CAACJ,KAAK,IAAIH,SAAS,EAC9B,OAAOO,UAAU,CAACJ,KAAK;EAC3B;AACF;AAAClD,OAAA,CAAAI,GAAA,GAAAA,GAAA;AAEM,SAASF,GAAGA,CAACO,KAAc,EAAc;EACzCJ,oBAAS,CAACkD,aAAa,CAAC9C,KAAK,CAAC;EAC7B,IAAIH,MAAM,GAAG,IAAIF,GAAG,CAACK,KAAK,CAAC,CAACH,MAAM;EAClC,IAAGG,KAAK,CAAC+C,aAAa,EAAE;IACpBlD,MAAM,CAACmD,OAAO,CAAC,CAAC;EACpB;EACApD,oBAAS,CAACkD,aAAa,CAAC9C,KAAK,CAAC;EAC9B,OAAOH,MAAM;AACjB;AAAC","ignoreList":[]}