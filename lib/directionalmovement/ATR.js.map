{"version":3,"file":"ATR.js","names":["_indicator","require","_WEMA","_TrueRange","ATRInput","IndicatorInput","low","high","close","period","exports","ATR","Indicator","result","generator","constructor","input","lows","highs","closes","format","length","trueRange","TrueRange","wema","WEMA","values","v","tick","avgTrueRange","trange","nextValue","undefined","next","forEach","index","value","push","calculate","atr","price","reverseInputs","reversedInput","reverse"],"sources":["../../src/directionalmovement/ATR.ts"],"sourcesContent":["import { Indicator, IndicatorInput } from '../indicator/indicator';\r\nimport { CandleData } from '../StockData';\r\n/**\r\n * Created by AAravindan on 5/8/16.\r\n */\r\n\"use strict\"\r\nimport { WEMA }         from '../moving_averages/WEMA';\r\nimport { TrueRange }    from './TrueRange';\r\n\r\nexport class ATRInput extends IndicatorInput {\r\n  low:number[]\r\n  high:number[]\r\n  close:number[]\r\n  period:number\r\n};\r\n\r\nexport class ATR extends Indicator {\r\n  result : number[];\r\n  generator:IterableIterator<number | undefined>;\r\n  constructor(input:ATRInput) {\r\n    super(input);\r\n    var lows = input.low;\r\n    var highs = input.high;\r\n    var closes = input.close;\r\n    var period = input.period;\r\n    var format = this.format;\r\n\r\n    if(!((lows.length === highs.length) && (highs.length === closes.length) )){\r\n      throw ('Inputs(low,high, close) not of equal size');\r\n    }\r\n\r\n    var trueRange = new TrueRange({\r\n      low : [],\r\n      high: [],\r\n      close: []\r\n    });\r\n\r\n\r\n    var wema = new WEMA({period : period, values : [], format : (v) => {return v}});\r\n\r\n\r\n    this.result = [];\r\n\r\n    this.generator = (function* (){\r\n      var tick = yield;\r\n      var avgTrueRange,trange;;\r\n      while (true) {\r\n        trange = trueRange.nextValue({\r\n          low : tick.low,\r\n          high : tick.high,\r\n          close : tick.close\r\n        });\r\n        if(trange === undefined){\r\n          avgTrueRange = undefined;\r\n        }else {\r\n          avgTrueRange = wema.nextValue(trange);\r\n        }\r\n        tick = yield avgTrueRange\r\n      }\r\n    })();\r\n\r\n    this.generator.next();\r\n\r\n    lows.forEach((tick,index) => {\r\n      var result = this.generator.next({\r\n        high : highs[index],\r\n        low  : lows[index],\r\n        close : closes[index]\r\n      });\r\n      if(result.value !== undefined){\r\n        this.result.push(format(result.value));\r\n      }\r\n    });\r\n  };\r\n\r\n  static calculate = atr;\r\n\r\n  nextValue(price:CandleData):number | undefined {\r\n      return this.generator.next(price).value;\r\n  };\r\n}\r\n\r\n\r\nexport function atr(input:ATRInput):number[] {\r\n  Indicator.reverseInputs(input);\r\n  var result = new ATR(input).result;\r\n  if(input.reversedInput) {\r\n      result.reverse();\r\n  }\r\n  Indicator.reverseInputs(input);\r\n  return result;\r\n};"],"mappings":"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","ignoreList":[]}