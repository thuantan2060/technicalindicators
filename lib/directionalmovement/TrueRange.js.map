{"version":3,"file":"TrueRange.js","names":["_indicator","require","TrueRangeInput","IndicatorInput","low","high","close","exports","TrueRange","Indicator","result","generator","constructor","input","lows","highs","closes","format","length","current","previousClose","undefined","Math","max","isNaN","abs","next","forEach","tick","index","value","push","calculate","truerange","nextValue","price","reverseInputs","reversedInput","reverse"],"sources":["../../src/directionalmovement/TrueRange.ts"],"sourcesContent":["import { CandleData } from '../StockData';\r\nimport { Indicator, IndicatorInput } from '../indicator/indicator';\r\n/**\r\n * Created by AAravindan on 5/8/16.\r\n */\r\n/**\r\n * Created by AAravindan on 5/8/16.\r\n */\r\n\"use strict\"\r\nexport class TrueRangeInput extends IndicatorInput {\r\n  low:number[];\r\n  high:number[]\r\n  close:number[]\r\n};\r\n\r\nexport class TrueRange extends Indicator {\r\n  result : number[];\r\n  generator:IterableIterator<number | undefined>;\r\n  constructor(input:TrueRangeInput) {\r\n    super(input);\r\n    var lows = input.low;\r\n    var highs = input.high;\r\n    var closes = input.close;\r\n    var format = this.format;\r\n\r\n    if(lows.length != highs.length) {\r\n      throw ('Inputs(low,high) not of equal size');\r\n    }\r\n\r\n    this.result = [];\r\n\r\n    this.generator = (function* ():IterableIterator<number | undefined >{\r\n      var current:CandleData = yield;\r\n      var previousClose,result;\r\n      while (true) {\r\n        if(previousClose === undefined) {\r\n          previousClose = current.close;\r\n          current = yield result;\r\n        }\r\n        result = Math.max(\r\n            current.high - current.low,\r\n            isNaN(Math.abs(current.high - previousClose)) ? 0 : Math.abs(current.high - previousClose),\r\n            isNaN(Math.abs(current.low - previousClose)) ? 0 : Math.abs(current.low - previousClose)\r\n        );\r\n        previousClose = current.close;\r\n        if(result != undefined){\r\n          result = format(result)\r\n        }\r\n        current = yield result;\r\n      }\r\n    })();\r\n\r\n    this.generator.next();\r\n\r\n    lows.forEach((tick, index) => {\r\n      var result = this.generator.next({\r\n        high : highs[index],\r\n        low  : lows[index],\r\n        close: closes[index]\r\n      });\r\n      if(result.value != undefined){\r\n        this.result.push(result.value);\r\n      }\r\n    });\r\n  };\r\n\r\n  static calculate = truerange;\r\n\r\n  nextValue(price:CandleData):number | undefined {\r\n     return this.generator.next(price).value;\r\n  };\r\n\r\n}\r\n\r\nexport function truerange(input:TrueRangeInput):number[] {\r\n    Indicator.reverseInputs(input);\r\n    var result = new TrueRange(input).result;\r\n    if(input.reversedInput) {\r\n        result.reverse();\r\n    }\r\n    Indicator.reverseInputs(input);\r\n    return result;\r\n};"],"mappings":"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","ignoreList":[]}