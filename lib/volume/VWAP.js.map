{"version":3,"file":"VWAP.js","names":["_indicator","require","VWAPInput","IndicatorInput","high","low","close","volume","exports","VWAP","Indicator","result","generator","constructor","input","lows","highs","closes","volumes","format","length","tick","cumulativeTotal","cumulativeVolume","typicalPrice","total","next","forEach","index","value","undefined","push","calculate","vwap","nextValue","price","reverseInputs","reversedInput","reverse"],"sources":["../../src/volume/VWAP.ts"],"sourcesContent":["import { CandleData } from '../StockData';\r\nimport { Indicator, IndicatorInput } from '../indicator/indicator';\r\n\r\nexport class VWAPInput extends IndicatorInput {\r\n  high : number[];\r\n  low :number[];\r\n  close : number[];\r\n  volume : number[]\r\n};\r\n\r\n\r\nexport class VWAP extends Indicator {\r\n  result : number[]\r\n  generator:IterableIterator<number | undefined>;;\r\n  constructor(input:VWAPInput) {\r\n    super(input);\r\n    var lows = input.low;\r\n    var highs = input.high;\r\n    var closes = input.close;\r\n    var volumes = input.volume;\r\n    var format = this.format;\r\n    \r\n    if(!((lows.length === highs.length) && (highs.length === closes.length) )){\r\n      throw ('Inputs(low,high, close) not of equal size');\r\n    }\r\n\r\n    this.result = [];\r\n\r\n    this.generator = (function* (){\r\n      var tick = yield;\r\n      let cumulativeTotal = 0;\r\n      let cumulativeVolume = 0;\r\n      while (true) {\r\n        let typicalPrice = (tick.high + tick.low + tick.close) / 3;\r\n        let total = tick.volume * typicalPrice;\r\n        cumulativeTotal = cumulativeTotal + total;\r\n        cumulativeVolume = cumulativeVolume + tick.volume;\r\n        tick = yield cumulativeTotal / cumulativeVolume;;\r\n      }\r\n    })();\r\n\r\n    this.generator.next();\r\n\r\n    lows.forEach((tick,index) => {\r\n      var result = this.generator.next({\r\n        high : highs[index],\r\n        low  : lows[index],\r\n        close : closes[index],\r\n        volume : volumes[index]\r\n      });\r\n      if(result.value != undefined){\r\n        this.result.push(result.value);\r\n      }\r\n    });\r\n  };\r\n\r\n  static calculate = vwap;\r\n\r\n  nextValue(price: CandleData):number | undefined {\r\n      let result = this.generator.next(price).value;\r\n      if(result != undefined) {\r\n        return result;\r\n      }\r\n  };\r\n}\r\n\r\nexport function vwap(input:VWAPInput):number[] {\r\n    Indicator.reverseInputs(input);\r\n    var result = new VWAP(input).result;\r\n    if(input.reversedInput) {\r\n        result.reverse();\r\n    }\r\n    Indicator.reverseInputs(input);\r\n    return result;\r\n  };"],"mappings":"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","ignoreList":[]}