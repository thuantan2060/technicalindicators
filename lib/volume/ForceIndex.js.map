{"version":3,"file":"ForceIndex.js","names":["_EMA","require","_indicator","ForceIndexInput","IndicatorInput","close","volume","period","exports","ForceIndex","Indicator","result","generator","constructor","input","closes","volumes","length","emaForceIndex","EMA","values","previousTick","tick","forceIndex","nextValue","next","forEach","index","value","undefined","push","calculate","forceindex","price","reverseInputs","reversedInput","reverse"],"sources":["../../src/volume/ForceIndex.ts"],"sourcesContent":["import { EMA } from '../moving_averages/EMA';\r\nimport { CandleData } from '../StockData';\r\nimport { Indicator, IndicatorInput } from '../indicator/indicator';\r\n\r\nexport class ForceIndexInput extends IndicatorInput {\r\n  close : number[];\r\n  volume : number[];\r\n  period : number = 1;\r\n};\r\n\r\n\r\nexport class ForceIndex extends Indicator {\r\n  result : number[]\r\n  generator:IterableIterator<number | undefined>;;\r\n  constructor(input:ForceIndexInput) {\r\n    super(input);\r\n    var closes = input.close;\r\n    var volumes = input.volume;\r\n    var period = input.period || 1\r\n    \r\n    if(!((volumes.length === closes.length))){\r\n      throw ('Inputs(volume, close) not of equal size');\r\n    }\r\n    let emaForceIndex = new EMA({ values : [], period: period })\r\n    this.result = [];\r\n\r\n    this.generator = (function* (){\r\n      var previousTick = yield;\r\n      var tick = yield;\r\n      let forceIndex;\r\n      while (true) {\r\n        forceIndex = (tick.close - previousTick.close) * tick.volume;\r\n        previousTick = tick;\r\n        tick = yield emaForceIndex.nextValue(forceIndex);\r\n      }\r\n    })();\r\n\r\n    this.generator.next();\r\n\r\n    volumes.forEach((tick,index) => {\r\n      var result = this.generator.next({\r\n        close : closes[index],\r\n        volume : volumes[index]\r\n      });\r\n      if(result.value != undefined){\r\n        this.result.push(result.value);\r\n      }\r\n    });\r\n  };\r\n\r\n  static calculate = forceindex;\r\n\r\n  nextValue(price: CandleData):number | undefined {\r\n      let result = this.generator.next(price).value;\r\n      if(result != undefined) {\r\n        return result;\r\n      }\r\n  };\r\n}\r\n\r\nexport function forceindex(input:ForceIndexInput):number[] {\r\n    Indicator.reverseInputs(input);\r\n    var result = new ForceIndex(input).result;\r\n    if(input.reversedInput) {\r\n        result.reverse();\r\n    }\r\n    Indicator.reverseInputs(input);\r\n    return result;\r\n  };"],"mappings":";;;;;;;AAAA,IAAAA,IAAA,GAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAD,OAAA;AAEO,MAAME,eAAe,SAASC,yBAAc,CAAC;EAClDC,KAAK;EACLC,MAAM;EACNC,MAAM,GAAY,CAAC;AACrB;AAACC,OAAA,CAAAL,eAAA,GAAAA,eAAA;AAAA;AAGM,MAAMM,UAAU,SAASC,oBAAS,CAAC;EACxCC,MAAM;EACNC,SAAS;EACTC,WAAWA,CAACC,KAAqB,EAAE;IACjC,KAAK,CAACA,KAAK,CAAC;IACZ,IAAIC,MAAM,GAAGD,KAAK,CAACT,KAAK;IACxB,IAAIW,OAAO,GAAGF,KAAK,CAACR,MAAM;IAC1B,IAAIC,MAAM,GAAGO,KAAK,CAACP,MAAM,IAAI,CAAC;IAE9B,IAAG,EAAGS,OAAO,CAACC,MAAM,KAAKF,MAAM,CAACE,MAAM,CAAE,EAAC;MACvC,MAAO,yCAAyC;IAClD;IACA,IAAIC,aAAa,GAAG,IAAIC,QAAG,CAAC;MAAEC,MAAM,EAAG,EAAE;MAAEb,MAAM,EAAEA;IAAO,CAAC,CAAC;IAC5D,IAAI,CAACI,MAAM,GAAG,EAAE;IAEhB,IAAI,CAACC,SAAS,GAAI,aAAY;MAC5B,IAAIS,YAAY,GAAG,KAAK;MACxB,IAAIC,IAAI,GAAG,KAAK;MAChB,IAAIC,UAAU;MACd,OAAO,IAAI,EAAE;QACXA,UAAU,GAAG,CAACD,IAAI,CAACjB,KAAK,GAAGgB,YAAY,CAAChB,KAAK,IAAIiB,IAAI,CAAChB,MAAM;QAC5De,YAAY,GAAGC,IAAI;QACnBA,IAAI,GAAG,MAAMJ,aAAa,CAACM,SAAS,CAACD,UAAU,CAAC;MAClD;IACF,CAAC,CAAE,CAAC;IAEJ,IAAI,CAACX,SAAS,CAACa,IAAI,CAAC,CAAC;IAErBT,OAAO,CAACU,OAAO,CAAC,CAACJ,IAAI,EAACK,KAAK,KAAK;MAC9B,IAAIhB,MAAM,GAAG,IAAI,CAACC,SAAS,CAACa,IAAI,CAAC;QAC/BpB,KAAK,EAAGU,MAAM,CAACY,KAAK,CAAC;QACrBrB,MAAM,EAAGU,OAAO,CAACW,KAAK;MACxB,CAAC,CAAC;MACF,IAAGhB,MAAM,CAACiB,KAAK,IAAIC,SAAS,EAAC;QAC3B,IAAI,CAAClB,MAAM,CAACmB,IAAI,CAACnB,MAAM,CAACiB,KAAK,CAAC;MAChC;IACF,CAAC,CAAC;EACJ;EAEA,OAAOG,SAAS,GAAGC,UAAU;EAE7BR,SAASA,CAACS,KAAiB,EAAqB;IAC5C,IAAItB,MAAM,GAAG,IAAI,CAACC,SAAS,CAACa,IAAI,CAACQ,KAAK,CAAC,CAACL,KAAK;IAC7C,IAAGjB,MAAM,IAAIkB,SAAS,EAAE;MACtB,OAAOlB,MAAM;IACf;EACJ;AACF;AAACH,OAAA,CAAAC,UAAA,GAAAA,UAAA;AAEM,SAASuB,UAAUA,CAAClB,KAAqB,EAAW;EACvDJ,oBAAS,CAACwB,aAAa,CAACpB,KAAK,CAAC;EAC9B,IAAIH,MAAM,GAAG,IAAIF,UAAU,CAACK,KAAK,CAAC,CAACH,MAAM;EACzC,IAAGG,KAAK,CAACqB,aAAa,EAAE;IACpBxB,MAAM,CAACyB,OAAO,CAAC,CAAC;EACpB;EACA1B,oBAAS,CAACwB,aAAa,CAACpB,KAAK,CAAC;EAC9B,OAAOH,MAAM;AACf;AAAC","ignoreList":[]}