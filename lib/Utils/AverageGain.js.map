{"version":3,"file":"AverageGain.js","names":["_indicator","require","AvgGainInput","IndicatorInput","period","values","exports","AverageGain","Indicator","generator","constructor","input","format","currentValue","counter","gainSum","avgGain","gain","lastValue","undefined","next","result","forEach","tick","value","push","calculate","averagegain","nextValue","price","reverseInputs","reversedInput","reverse"],"sources":["../../src/Utils/AverageGain.ts"],"sourcesContent":["import { Indicator, IndicatorInput } from '../indicator/indicator';\r\n\r\n\r\nexport class AvgGainInput extends IndicatorInput {\r\n  period:number\r\n  values:number[]\r\n}\r\n\r\nexport class AverageGain extends Indicator {\r\n  generator:IterableIterator<number | undefined>;\r\n  constructor(input:AvgGainInput) {\r\n    super(input);\r\n    let values = input.values;\r\n    let period = input.period;\r\n    let format = this.format;\r\n\r\n    this.generator = (function* (period){\r\n      var currentValue = yield;\r\n      var counter = 1;\r\n      var gainSum = 0;\r\n      var avgGain;\r\n      var gain;\r\n      var lastValue = currentValue;\r\n      currentValue = yield\r\n      while(true){\r\n        gain = currentValue - lastValue;\r\n        gain = gain > 0 ? gain : 0;\r\n        if(gain > 0){\r\n          gainSum = gainSum + gain;\r\n        }\r\n        if(counter < period){\r\n          counter++;\r\n        }\r\n        else if(avgGain === undefined){\r\n          avgGain = gainSum / period;\r\n        }else {\r\n          avgGain = ((avgGain * (period-1)) + gain)/period;\r\n        }\r\n        lastValue = currentValue;\r\n        avgGain = (avgGain!==undefined) ? format(avgGain) : undefined;\r\n        currentValue = yield avgGain;\r\n      }\r\n    })(period);\r\n\r\n    this.generator.next();\r\n\r\n    this.result = [];\r\n\r\n    values.forEach((tick:number) => {\r\n      var result = this.generator.next(tick);\r\n      if(result.value !== undefined){\r\n        this.result.push(result.value);\r\n      }\r\n    });\r\n  }\r\n\r\n  static calculate = averagegain;\r\n\r\n    nextValue(price:number):number | undefined {\r\n        return this.generator.next(price).value;\r\n    };\r\n}\r\n\r\nexport function averagegain(input:AvgGainInput):number[] {\r\n       Indicator.reverseInputs(input);\r\n        var result = new AverageGain(input).result;\r\n        if(input.reversedInput) {\r\n            result.reverse();\r\n        }\r\n        Indicator.reverseInputs(input);\r\n        return result;\r\n    };"],"mappings":";;;;;;;AAAA,IAAAA,UAAA,GAAAC,OAAA;AAGO,MAAMC,YAAY,SAASC,yBAAc,CAAC;EAC/CC,MAAM;EACNC,MAAM;AACR;AAACC,OAAA,CAAAJ,YAAA,GAAAA,YAAA;AAEM,MAAMK,WAAW,SAASC,oBAAS,CAAC;EACzCC,SAAS;EACTC,WAAWA,CAACC,KAAkB,EAAE;IAC9B,KAAK,CAACA,KAAK,CAAC;IACZ,IAAIN,MAAM,GAAGM,KAAK,CAACN,MAAM;IACzB,IAAID,MAAM,GAAGO,KAAK,CAACP,MAAM;IACzB,IAAIQ,MAAM,GAAG,IAAI,CAACA,MAAM;IAExB,IAAI,CAACH,SAAS,GAAI,WAAWL,MAAM,EAAC;MAClC,IAAIS,YAAY,GAAG,KAAK;MACxB,IAAIC,OAAO,GAAG,CAAC;MACf,IAAIC,OAAO,GAAG,CAAC;MACf,IAAIC,OAAO;MACX,IAAIC,IAAI;MACR,IAAIC,SAAS,GAAGL,YAAY;MAC5BA,YAAY,GAAG,KAAK;MACpB,OAAM,IAAI,EAAC;QACTI,IAAI,GAAGJ,YAAY,GAAGK,SAAS;QAC/BD,IAAI,GAAGA,IAAI,GAAG,CAAC,GAAGA,IAAI,GAAG,CAAC;QAC1B,IAAGA,IAAI,GAAG,CAAC,EAAC;UACVF,OAAO,GAAGA,OAAO,GAAGE,IAAI;QAC1B;QACA,IAAGH,OAAO,GAAGV,MAAM,EAAC;UAClBU,OAAO,EAAE;QACX,CAAC,MACI,IAAGE,OAAO,KAAKG,SAAS,EAAC;UAC5BH,OAAO,GAAGD,OAAO,GAAGX,MAAM;QAC5B,CAAC,MAAK;UACJY,OAAO,GAAG,CAAEA,OAAO,IAAIZ,MAAM,GAAC,CAAC,CAAC,GAAIa,IAAI,IAAEb,MAAM;QAClD;QACAc,SAAS,GAAGL,YAAY;QACxBG,OAAO,GAAIA,OAAO,KAAGG,SAAS,GAAIP,MAAM,CAACI,OAAO,CAAC,GAAGG,SAAS;QAC7DN,YAAY,GAAG,MAAMG,OAAO;MAC9B;IACF,CAAC,CAAEZ,MAAM,CAAC;IAEV,IAAI,CAACK,SAAS,CAACW,IAAI,CAAC,CAAC;IAErB,IAAI,CAACC,MAAM,GAAG,EAAE;IAEhBhB,MAAM,CAACiB,OAAO,CAAEC,IAAW,IAAK;MAC9B,IAAIF,MAAM,GAAG,IAAI,CAACZ,SAAS,CAACW,IAAI,CAACG,IAAI,CAAC;MACtC,IAAGF,MAAM,CAACG,KAAK,KAAKL,SAAS,EAAC;QAC5B,IAAI,CAACE,MAAM,CAACI,IAAI,CAACJ,MAAM,CAACG,KAAK,CAAC;MAChC;IACF,CAAC,CAAC;EACJ;EAEA,OAAOE,SAAS,GAAGC,WAAW;EAE5BC,SAASA,CAACC,KAAY,EAAqB;IACvC,OAAO,IAAI,CAACpB,SAAS,CAACW,IAAI,CAACS,KAAK,CAAC,CAACL,KAAK;EAC3C;AACJ;AAAClB,OAAA,CAAAC,WAAA,GAAAA,WAAA;AAEM,SAASoB,WAAWA,CAAChB,KAAkB,EAAW;EAClDH,oBAAS,CAACsB,aAAa,CAACnB,KAAK,CAAC;EAC7B,IAAIU,MAAM,GAAG,IAAId,WAAW,CAACI,KAAK,CAAC,CAACU,MAAM;EAC1C,IAAGV,KAAK,CAACoB,aAAa,EAAE;IACpBV,MAAM,CAACW,OAAO,CAAC,CAAC;EACpB;EACAxB,oBAAS,CAACsB,aAAa,CAACnB,KAAK,CAAC;EAC9B,OAAOU,MAAM;AACjB;AAAC","ignoreList":[]}