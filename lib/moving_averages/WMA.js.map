{"version":3,"file":"WMA.js","names":["Object","defineProperty","exports","value","WMA","wma","_indicator","require","_LinkedList","Indicator","period","price","result","generator","constructor","input","priceArray","values","data","LinkedList","denominator","length","push","resetCursor","i","next","shift","forEach","tick","index","undefined","format","calculate","nextValue","reverseInputs","reversedInput","reverse"],"sources":["../../src/moving_averages/WMA.ts"],"sourcesContent":["\"use strict\"\r\nimport { Indicator, IndicatorInput } from '../indicator/indicator';\r\nimport { MAInput } from './SMA';\r\nimport { LinkedList } from '../Utils/LinkedList';\r\n\r\nexport class WMA extends Indicator{\r\n  period:number;\r\n  price:number[];\r\n  result : number[];\r\n  generator:IterableIterator<number | undefined>;\r\n  constructor (input:MAInput) {\r\n    super(input);\r\n    var period = input.period;\r\n    var priceArray = input.values;\r\n    this.result = [];\r\n    this.generator = (function* (){\r\n      let data = new LinkedList();\r\n      let denominator = period * (period + 1)/2;\r\n\r\n      while (true) {\r\n        if((data.length) < period ){\r\n          data.push(yield)\r\n        }else {\r\n          data.resetCursor();\r\n          let result = 0;\r\n          for(let i=1; i<=period; i++){\r\n            result = result + (data.next() * i/(denominator))\r\n          }\r\n          var next = yield result;\r\n          data.shift();\r\n          data.push(next);\r\n        }\r\n      }\r\n    })();\r\n\r\n    this.generator.next();\r\n\r\n    priceArray.forEach((tick, index) => {\r\n      var result = this.generator.next(tick)\r\n      if(result.value != undefined){\r\n        this.result.push(this.format(result.value));\r\n      }\r\n    });\r\n  }\r\n\r\n  static calculate = wma;\r\n\r\n    //STEP 5. REMOVE GET RESULT FUNCTION\r\n  nextValue(price:number):number | undefined {\r\n      var result = this.generator.next(price).value;\r\n      if(result != undefined)\r\n          return this.format(result);\r\n  };\r\n\r\n};\r\n\r\nexport function wma(input:MAInput):number[] {\r\n      Indicator.reverseInputs(input);\r\n      var result = new WMA(input).result;\r\n      if(input.reversedInput) {\r\n          result.reverse();\r\n      }\r\n      Indicator.reverseInputs(input);\r\n      return result;\r\n  }\r\n"],"mappings":"AAAA,YAAY;;AAAAA,MAAA,CAAAC,cAAA,CAAAC,OAAA;EAAAC,KAAA;AAAA;AAAAD,OAAA,CAAAE,GAAA;AAAAF,OAAA,CAAAG,GAAA,GAAAA,GAAA;AACZ,IAAAC,UAAA,GAAAC,OAAA;AAEA,IAAAC,WAAA,GAAAD,OAAA;AAEO,MAAMH,GAAG,SAASK,oBAAS;EAChCC,MAAM;EACNC,KAAK;EACLC,MAAM;EACNC,SAAS;EACTC,WAAWA,CAAEC,KAAa,EAAE;IAC1B,KAAK,CAACA,KAAK,CAAC;IACZ,IAAIL,MAAM,GAAGK,KAAK,CAACL,MAAM;IACzB,IAAIM,UAAU,GAAGD,KAAK,CAACE,MAAM;IAC7B,IAAI,CAACL,MAAM,GAAG,EAAE;IAChB,IAAI,CAACC,SAAS,GAAI,aAAY;MAC5B,IAAIK,IAAI,GAAG,IAAIC,sBAAU,CAAC,CAAC;MAC3B,IAAIC,WAAW,GAAGV,MAAM,IAAIA,MAAM,GAAG,CAAC,CAAC,GAAC,CAAC;MAEzC,OAAO,IAAI,EAAE;QACX,IAAIQ,IAAI,CAACG,MAAM,GAAIX,MAAM,EAAE;UACzBQ,IAAI,CAACI,IAAI,CAAC,KAAK,CAAC;QAClB,CAAC,MAAK;UACJJ,IAAI,CAACK,WAAW,CAAC,CAAC;UAClB,IAAIX,MAAM,GAAG,CAAC;UACd,KAAI,IAAIY,CAAC,GAAC,CAAC,EAAEA,CAAC,IAAEd,MAAM,EAAEc,CAAC,EAAE,EAAC;YAC1BZ,MAAM,GAAGA,MAAM,GAAIM,IAAI,CAACO,IAAI,CAAC,CAAC,GAAGD,CAAC,GAAEJ,WAAa;UACnD;UACA,IAAIK,IAAI,GAAG,MAAMb,MAAM;UACvBM,IAAI,CAACQ,KAAK,CAAC,CAAC;UACZR,IAAI,CAACI,IAAI,CAACG,IAAI,CAAC;QACjB;MACF;IACF,CAAC,CAAE,CAAC;IAEJ,IAAI,CAACZ,SAAS,CAACY,IAAI,CAAC,CAAC;IAErBT,UAAU,CAACW,OAAO,CAAC,CAACC,IAAI,EAAEC,KAAK,KAAK;MAClC,IAAIjB,MAAM,GAAG,IAAI,CAACC,SAAS,CAACY,IAAI,CAACG,IAAI,CAAC;MACtC,IAAGhB,MAAM,CAACT,KAAK,IAAI2B,SAAS,EAAC;QAC3B,IAAI,CAAClB,MAAM,CAACU,IAAI,CAAC,IAAI,CAACS,MAAM,CAACnB,MAAM,CAACT,KAAK,CAAC,CAAC;MAC7C;IACF,CAAC,CAAC;EACJ;EAEA,OAAO6B,SAAS,GAAG3B,GAAG;;EAEpB;EACF4B,SAASA,CAACtB,KAAY,EAAqB;IACvC,IAAIC,MAAM,GAAG,IAAI,CAACC,SAAS,CAACY,IAAI,CAACd,KAAK,CAAC,CAACR,KAAK;IAC7C,IAAGS,MAAM,IAAIkB,SAAS,EAClB,OAAO,IAAI,CAACC,MAAM,CAACnB,MAAM,CAAC;EAClC;AAEF;AAACV,OAAA,CAAAE,GAAA,GAAAA,GAAA;AAAA;AAEM,SAASC,GAAGA,CAACU,KAAa,EAAW;EACtCN,oBAAS,CAACyB,aAAa,CAACnB,KAAK,CAAC;EAC9B,IAAIH,MAAM,GAAG,IAAIR,GAAG,CAACW,KAAK,CAAC,CAACH,MAAM;EAClC,IAAGG,KAAK,CAACoB,aAAa,EAAE;IACpBvB,MAAM,CAACwB,OAAO,CAAC,CAAC;EACpB;EACA3B,oBAAS,CAACyB,aAAa,CAACnB,KAAK,CAAC;EAC9B,OAAOH,MAAM;AACjB","ignoreList":[]}